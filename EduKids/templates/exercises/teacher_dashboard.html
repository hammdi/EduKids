{% extends 'base/base.html' %} {% load static %} {% block content %}
<div class="container">
  <h1>Teacher Dashboard</h1>

  <!-- Stats Cards -->
  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Total Classes</h5>
          <h2>{{ total_subjects }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Total Students</h5>
          <h2>{{ total_students }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">Recent Results</h5>
          <h2>{{ recent_results|length }}</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Classes/Subjects (Card Grid like subjects_list) -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3>Your Classes</h3>
    <a href="{% url 'subjects_list' %}" class="btn btn-primary">
      <i class="fas fa-plus me-1"></i>Manage All Classes
    </a>
  </div>

  <div class="row">
    {% for subject in subjects %}
    <div class="col-md-4 mb-4">
      <a
        href="{% url 'subject_detail' subject.pk %}"
        class="text-decoration-none"
      >
        <div class="card h-100">
          {% if subject.image %}
          <img
            src="{{ subject.image.url }}"
            class="card-img-top"
            alt="{{ subject.name }}"
            style="height: 200px; object-fit: cover"
          />
          {% endif %}
          <div class="card-body">
            <h5 class="card-title">
              {% if subject.icon %}
              <i class="fas {{ subject.icon }} me-2"></i>
              {% endif %}{{ subject.name }}
            </h5>
            <p class="card-text">{{ subject.description|truncatechars:100 }}</p>
            <p class="text-muted">
              Grade: {{ subject.grade_level }} | Students: {{
              subject.student_count }}
            </p>
          </div>
        </div>
      </a>
    </div>
    {% empty %}
    <div class="col-12">
      <div class="alert alert-info text-center">
        <h4>No classes available</h4>
        <p>Click "Manage All Classes" to create your first class.</p>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Recent Activity -->
  <h3>Recent Student Results</h3>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Student</th>
          <th>Exercise</th>
          <th>Score</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for result in recent_results %}
        <tr>
          <td>{{ result.student.username }}</td>
          <td>{{ result.exercise.name }}</td>
          <td>{{ result.score|floatformat:1 }}%</td>
          <td>{{ result.completed_at|date:"M d, Y H:i" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4">No recent results.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
